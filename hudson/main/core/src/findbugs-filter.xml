<FindBugsFilter>
  <Match>
    <Or>
      <!-- It's hard to imagine a scenario where Hudson is granted higher privilege but called by a lower privileged client. -->
      <Bug pattern="DP_CREATE_CLASSLOADER_INSIDE_DO_PRIVILEGED" />

      <!-- exposing internal data structure via array is considered OK in Hudson. Hudson really doesn't try to defend against the malicious code -->
      <Bug pattern="EI_EXPOSE_REP" />
      <Bug pattern="EI_EXPOSE_REP2" />

      <!-- FindBugs detect false positives. -->
      <Bug pattern="SBSC_USE_STRINGBUFFER_CONCATENATION" />
    </Or>
  </Match>

  <Match>
    <!-- Hudson defines mutable static field throughout the code so that debug features can be selectively made on and off at runtime -->
    <Bug pattern="MS_SHOULD_BE_FINAL" />
  </Match>

  <Match>
    <!-- archiveReader.readLine() may never return null since it's the first invocation -->
    <Class name="hudson.PluginWrapper"/>
    <Bug pattern="NP_NULL_ON_SOME_PATH_FROM_RETURN_VALUE" />
  </Match>

  <Match>
    <!-- PrintWriter doesn't carry any resource, so let it GC-ed is harmless. -->
    <Class name="hudson.TcpSlaveAgentListener$ConnectionHandler" />
    <Bug pattern="OS_OPEN_STREAM" />
  </Match>

  <Match>
    <!-- this use of mutable static field is necessary to propagate a value inside Maven. -->
    <Class name="hudson.maven.MavenBuilder" />
    <Bug pattern="MS_CANNOT_BE_FINAL" />
  </Match>

  <Match>
    <!-- this class is not serialized -->
    <Or>
      <Class name="hudson.maven.MavenProbeAction" />
      <Class name="hudson.maven.SplittableBuildListener" />
      <Class name="hudson.maven.MavenBuild$ProxyImpl" />
      <Class name="hudson.maven.MavenBuild$ProxyImpl2" />
    </Or>
    <Bug code="SE" />
  </Match>

  <Match>
    <!-- FindBugs fail to take the writeObject method into account. -->
    <Class name="hudson.maven.MavenProcessFactory$Connection" />
    <Bug code="SE" />
  </Match>

  <Match>
    <Class name="hudson.util.ProcessTreeKiller$Unix$UnixSystem" />
    <Bug pattern="DMI_HARDCODED_ABSOLUTE_FILENAME" />
  </Match>

  <Match>
    <!-- Can't change this for backward compatibility -->
    <Class name="hudson.tasks.BuildWrapper$Environment" />
    <Bug pattern="SIC_INNER_SHOULD_BE_STATIC" />
  </Match>

</FindBugsFilter>